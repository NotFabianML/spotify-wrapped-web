---
import Typography from "@/components/Typography.astro";
import Action from "./Action.astro";
---

<section class="h-full flex flex-col justify-center items-center">
  <div class="flex justify-center flex-col sm:absolute sm:top-0 sm:left-0 p-8">
    <Typography
      as="h1"
      variant="big"
      color="white"
      class:list={"font-bold text-5xl sm:text-8xl"}
    >
      SPOTIFY
    </Typography>
  </div>

  <div
    class="flex flex-col justify-center items-center h-[70vh] sm:h-screen px-8 text-sm sm:text-lg"
  >
    <p class="text-center text-white">
      Spotify Wrapped gives you stats about your top artists and songs. <br /> To
      use it, you'll need to login with your Spotify account.
    </p>

    <Action
      id="login"
      class="w-8/12 text-sm md:text-base text-white mt-5"
      as="button"
      aria-label="Iniciar sesión de usuario"
    >
      ¡Inicia sesión para participar!
    </Action>
    <div>Iniciar sesion</div>
  </div>

  <div
    class="flex justify-center flex-col sm:absolute sm:bottom-0 sm:right-0 p-8"
  >
    <Typography
      as="h2"
      variant="big"
      color="white"
      class:list={"font-bold text-5xl sm:text-8xl"}
    >
      WRAPPED
    </Typography>
  </div>
</section>

<script>
  import { $ } from "@/lib/dom-selector";

  const { signIn } = await import("auth-astro/client");
  const $login = $("#login");

  if ($login) {
    $login.onclick = () => {
      signIn("spotify");
      $login.setAttribute("aria-disabled", "true");

      const $span = $login.querySelector("span");
      if ($span) $span.innerText = "Iniciando sesión...";
    };
  }
</script>
